#!/usr/bin/env bash
set -euo pipefail

log="$(dirname "$0")/log.txt"
mkdir -p "$(dirname "$log")"

echo "journalctl $*" >> "$log"

unit=""
lines=""

args=("$@")
idx=0
while (( idx < ${#args[@]} )); do
  arg="${args[$idx]}"
  if [[ "$arg" == "-u" ]]; then
    idx=$((idx + 1))
    unit="${args[$idx]:-}"
  elif [[ "$arg" == "-n" ]]; then
    idx=$((idx + 1))
    lines="${args[$idx]:-}"
  fi
  idx=$((idx + 1))
done

if [[ -z "$lines" ]]; then
  lines="0"
fi

echo "MOCK journalctl unit=$unit lines=$lines"
echo "2025-01-01T00:00:00.000000+00:00 host $unit[123]: mock journal line 1"
echo "2025-01-01T00:00:01.000000+00:00 host $unit[123]: mock journal line 2"

exit 0
